import classNames from "classnames";
import styles from "./StatusIndicator.module.css";
import { tourStatus } from "@/types";
import { TEMP_animationOptions, getStatusColor } from "@/lib/utils";
import { motion } from "framer-motion";

const WaitingIcon = (props) => (
  <svg
    width={16}
    height={17}
    viewBox="0 0 16 17"
    fill="none"
    xmlns="http://www.w3.org/2000/svg"
    {...props}
  >
    <path
      d="M8 1.93018C8 1.37789 8.44944 0.923734 8.99741 0.992592C10.1655 1.13937 11.2911 1.54276 12.2916 2.17872C13.5745 2.99417 14.5984 4.15824 15.2436 5.53462C15.8888 6.911 16.1285 8.44271 15.9347 9.9504C15.7408 11.4581 15.1214 12.8793 14.149 14.0477C13.1766 15.2161 11.8915 16.0833 10.4441 16.5477C8.99664 17.0121 7.44686 17.0545 5.97621 16.67C4.50556 16.2854 3.1749 15.4898 2.14006 14.3764C1.33301 13.508 0.73193 12.4744 0.375485 11.3523C0.208269 10.826 0.573266 10.3015 1.11637 10.2013L7.18158 9.0813C7.65582 8.99373 8 8.58017 8 8.09792L8 1.93018Z"
      fill="#DDDDE3"
    />
  </svg>
);

const CheckIcon = (props) => (
  <svg
    width={14}
    height={11}
    viewBox="0 0 14 11"
    fill="none"
    xmlns="http://www.w3.org/2000/svg"
    {...props}
  >
    <path
      d="M12.3333 1.79053L4.99996 9.12386L1.66663 5.79053"
      stroke="#193B2D"
      strokeWidth={2.5}
      strokeLinecap="round"
      strokeLinejoin="round"
    />
  </svg>
);

const CarIcon = (props) => (
  <svg
    width={16}
    height={13}
    viewBox="0 0 16 13"
    fill="none"
    xmlns="http://www.w3.org/2000/svg"
    {...props}
  >
    <path
      fillRule="evenodd"
      clipRule="evenodd"
      d="M5.16423 0.334078L5.26096 0.334174H10.1869L10.2837 0.334078C10.7394 0.333397 11.1394 0.3328 11.4959 0.472983C11.8075 0.595559 12.0834 0.794419 12.2983 1.05133C12.544 1.34514 12.6699 1.72482 12.8134 2.1574L12.8439 2.2492L13.4481 4.0617L14.094 3.73872C14.4234 3.57402 14.824 3.70754 14.9887 4.03693C15.1534 4.36633 15.0199 4.76688 14.6905 4.93158L14.2921 5.13076C14.4826 5.32415 14.6436 5.54667 14.7683 5.79153C14.9332 6.11517 14.999 6.45972 15.0296 6.83454C15.0591 7.19544 15.0591 7.63847 15.0591 8.17527V10.0032L15.0591 10.0591V10.0592C15.0593 10.313 15.0595 10.5316 15.0206 10.7269C14.8628 11.5205 14.2424 12.1408 13.4489 12.2987C13.2536 12.3375 13.035 12.3373 12.7811 12.3371H12.7811L12.7252 12.3371H12.3917C11.4005 12.3371 10.5777 11.6162 10.4189 10.67H5.02896C4.87023 11.6162 4.04738 12.3371 3.05614 12.3371H2.72272L2.66679 12.3371H2.66677C2.41291 12.3373 2.19431 12.3375 1.99903 12.2987C1.20546 12.1408 0.585109 11.5205 0.427257 10.7269C0.388412 10.5316 0.388586 10.313 0.388788 10.0591L0.388818 10.0032L0.388818 8.17522C0.388809 7.63844 0.388802 7.19543 0.418288 6.83454C0.448912 6.45972 0.514637 6.11517 0.679538 5.79153C0.804298 5.54668 0.965314 5.32415 1.15579 5.13076L0.757432 4.93158C0.428033 4.76688 0.294517 4.36633 0.459217 4.03693C0.623917 3.70754 1.02446 3.57402 1.35386 3.73872L1.99983 4.0617L2.604 2.2492L2.6345 2.1574L2.6345 2.1574C2.77798 1.72482 2.90391 1.34514 3.14961 1.05133C3.36445 0.79442 3.64036 0.59556 3.95202 0.472983C4.30845 0.3328 4.70847 0.333397 5.16423 0.334078ZM4.22886 4.33515H4.22887H4.22889H11.219H11.219H11.219C11.5619 4.33514 11.8666 4.33514 12.136 4.34282L11.5787 2.67094C11.3858 2.09229 11.3367 1.98037 11.2752 1.90689C11.2036 1.82125 11.1116 1.75496 11.0077 1.7141C10.9186 1.67904 10.7969 1.66783 10.1869 1.66783H5.26096C4.65101 1.66783 4.5293 1.67904 4.44015 1.7141C4.33626 1.75496 4.24429 1.82125 4.17268 1.90688C4.11122 1.98037 4.0621 2.09229 3.86922 2.67094L3.31192 4.34282C3.58133 4.33514 3.88596 4.33514 4.22886 4.33515ZM4.59719 6.88722C4.59719 7.42628 4.1602 7.86327 3.62113 7.86327C3.08207 7.86327 2.64508 7.42628 2.64508 6.88722C2.64508 6.34816 3.08207 5.91116 3.62113 5.91116C4.1602 5.91116 4.59719 6.34816 4.59719 6.88722ZM11.737 8.00474C12.2761 8.00474 12.7131 7.56775 12.7131 7.02869C12.7131 6.48963 12.2761 6.05263 11.737 6.05263C11.198 6.05263 10.761 6.48963 10.761 7.02869C10.761 7.56775 11.198 8.00474 11.737 8.00474Z"
      fill="currentColor"
    />
  </svg>
);

const FlagIcon = (props) => (
  <svg
    width={14}
    height={17}
    viewBox="0 0 14 17"
    fill="none"
    xmlns="http://www.w3.org/2000/svg"
    {...props}
  >
    <path
      d="M1.66663 10.5111C1.66663 10.5111 2.33329 9.84448 4.33329 9.84448C6.33329 9.84448 7.66663 11.1778 9.66663 11.1778C11.6666 11.1778 12.3333 10.5111 12.3333 10.5111V2.51115C12.3333 2.51115 11.6666 3.17782 9.66663 3.17782C7.66663 3.17782 6.33329 1.84448 4.33329 1.84448C2.33329 1.84448 1.66663 2.51115 1.66663 2.51115V10.5111Z"
      fill="#0B68CB"
    />
    <path
      d="M1.66663 2.51115C1.66663 2.51115 2.33329 1.84448 4.33329 1.84448C6.33329 1.84448 7.66663 3.17782 9.66663 3.17782C11.6666 3.17782 12.3333 2.51115 12.3333 2.51115V10.5111C12.3333 10.5111 11.6666 11.1778 9.66663 11.1778C7.66663 11.1778 6.33329 9.84448 4.33329 9.84448C2.33329 9.84448 1.66663 10.5111 1.66663 10.5111V2.51115ZM1.66663 2.51115L1.66663 15.1778"
      stroke="#0B68CB"
      strokeWidth={2}
      strokeLinecap="round"
      strokeLinejoin="round"
    />
  </svg>
);

const AbortIcon = (props) => (
  <svg
    width={10}
    height={10}
    viewBox="0 0 10 10"
    fill="none"
    xmlns="http://www.w3.org/2000/svg"
    {...props}
  >
    <path
      d="M8.33329 1.5968L1.66663 8.26347M1.66663 1.5968L8.33329 8.26347"
      stroke="#641723"
      strokeWidth={2.5}
      strokeLinecap="round"
      strokeLinejoin="round"
    />
  </svg>
);

type StatusIndicator = {
  status: tourStatus;
  className?: string;
};

const StatusIndicator = (props) => {
  const { status, className, ...rest } = props;

  const statusIconMap = {
    geplant: WaitingIcon,
    "fahrzeug kommt": WaitingIcon,
    "kunde eingestiegen": CarIcon,
    "fahre zum ziel": CarIcon,
    "auftrag abgeschlossen": FlagIcon,
    "auftrag storniert": AbortIcon,
  };

  const lowerCaseStatus = status.toLowerCase();
  const Icon = statusIconMap[lowerCaseStatus] || null;

  const statusColor = getStatusColor(status);

  return (
    <motion.div
      className={classNames(styles.indicator, styles[statusColor], className)}
      data-status={lowerCaseStatus}
      {...rest}
    >
      <div className={styles.inner}>
        <Icon />
      </div>
    </motion.div>
  );
};

export default StatusIndicator;
